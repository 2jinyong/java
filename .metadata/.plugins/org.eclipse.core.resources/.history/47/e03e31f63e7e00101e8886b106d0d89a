package world;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class ConnectionExam {

   public static void main(String[] args) {
      
      Connection conn = null;
      try {
         //JDBC Driver 등록
         Class.forName("com.mysql.cj.jdbc.Driver");
         System.out.println("드라이버가 성공적으로 로드 되었습니다.");
         
         String url = "jdbc:mysql://localhost:3306/world";
         String user = "root";
         String password = "1234";
         
         conn = DriverManager.getConnection(url, user, password);
         System.out.println("world db 연결 성공");
         
         String sql = "insert into sampleTable (name,password,title) values (?,?,?)";
         int rs = 0;
         //변수값이 있을때는 PreparedStatement
         PreparedStatement pstmt = conn.prepareStatement(sql);
         pstmt.setString(1, "홍길자");
         pstmt.setString(2, "123456");
         pstmt.setString(3, "홍길자는 강적이다.");
         rs += pstmt.executeUpdate();
         pstmt.setString(1, "김철수");
         pstmt.setString(2, "123456");
         pstmt.setString(3, "김철수는 회사원이다.");
         rs += pstmt.executeUpdate();
         pstmt.setString(1, "이순이");
         pstmt.setString(2, "123456");
         pstmt.setString(3, "이순이는 이순이다.");
         rs += pstmt.executeUpdate();
         pstmt.setString(1, "박말자");
         pstmt.setString(2, "123456");
         pstmt.setString(3, "박말자는 주부이다.");
         rs += pstmt.executeUpdate();
         pstmt.setString(1, "홍길동");
         pstmt.setString(2, "123456");
         pstmt.setString(3, "홍길동은 도적이다.");
         rs += pstmt.executeUpdate();
         System.out.println("저장된 행의 수는 " + rs);
         
         pstmt.close();
         
      }catch(ClassNotFoundException e) {
         e.printStackTrace();
      }catch(SQLException e) {
         e.printStackTrace();
      }finally {
         if(conn != null) 
            try {
               conn.close();
               System.out.println("연결을 끊었습니다.");
            }catch(SQLException e) {}
      }

   }

}
